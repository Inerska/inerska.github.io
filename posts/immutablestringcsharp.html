<!DOCTYPE html>
<html lang="fr">

    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Alexis C. GRIDEL's blog, covering a lot of notions and concepts, .NET, Python, Pawn, SAMP, C# lover.">
<meta name="keywords" content="C#, blog, .NET, Python, Pawn, SAMP, modern, covid, linux, visual, microsoft, alexis gridel, alexis chân gridel, gridel, inerska, ergazia, c sharp, net framework 4.8, microsoft net framework, net framework 4.5, net 5.0, net 6.0, gta samp, san andreas multiplayer,  gta san andreas multiplayer,  mvp nba">
<meta name="author" content="Alexis C. GRIDEL">
<meta property="og:type" content="website">
<meta property="og:url" content="https://agdl.dev/">
<meta property="og:title" content="Alexis C. GRIDEL">
<meta property="og:description" content="Alexis C. GRIDEL's blog, covering a lot of notions and concepts, .NET, Python, Pawn, SAMP, C# lover.">
<meta property="og:image" content="https://yt3.ggpht.com/ytc/AAUvwngaEmUiSBc-7ShOeKr-jsiO5grO3GrWRlVZiLEa=s88-c-k-c0x00ffffff-no-rj">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://agdl.dev/">
<meta property="twitter:title" content="Alexis C. GRIDEL">
<meta property="twitter:description" content="Alexis C. GRIDEL's blog, covering a lot of notions and concepts, .NET, Python, Pawn, SAMP, C# lover.">
<meta property="twitter:image" content="https://yt3.ggpht.com/ytc/AAUvwngaEmUiSBc-7ShOeKr-jsiO5grO3GrWRlVZiLEa=s88-c-k-c0x00ffffff-no-rj">
<title>Alexis C. GRIDEL's blog</title>

<script data-ad-client="ca-pub-9403387570099751" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<link rel="shortcut icon" href="https://yt3.ggpht.com/ytc/AAUvwngaEmUiSBc-7ShOeKr-jsiO5grO3GrWRlVZiLEa=s88-c-k-c0x00ffffff-no-rj" type="image/x-icon">
<link rel="apple-touch-icon" href="https://yt3.ggpht.com/ytc/AAUvwngaEmUiSBc-7ShOeKr-jsiO5grO3GrWRlVZiLEa=s88-c-k-c0x00ffffff-no-rj">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.2/css/bulma.min.css">
<link rel="stylesheet" href="/css/post.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/themes/prism-okaidia.css">
    </head>

    <body>
        <nav class="navbar is-fixed-top bg-light">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item title--link" href="/">
                <span class="has-text-weight-bold">agdl.dev</span>
            </a>
            <span class="navbar-burger" data-target="navbarMenuHeroB">
                <span></span>
                <span></span>
                <span></span>
            </span>
        </div>
        <div id="navbarMenuHeroB" class="navbar-menu">
            <div class="navbar-end">
                <a class="navbar-item is-active" href="/">
                    Home
                </a>
                <a class="navbar-item" href="/about#about__content">
                    About
                </a>
                <a class="navbar-item" href="mailto:contact@agdl.dev">
                    Contact
                </a>
            </div>
        </div>
    </div>
</nav>
        
<section class="container content__spacing feed-article__top section ">
    <p class="mb-5 article-meta__tag">csharp</p>
    <a href="/posts/immutablestringcsharp">
        <h1><a href="/posts/immutablestringcsharp">How to edit a default immutable string without creating a copy</a></h1>
    </a>
    <div class="feed-article__metas">
        <div class="is-flex is-justify-content-space-between">
            <div class="is-flex is-align-items-center is-flex-direction-row">
                <div class="is-flex is-flex-direction-row is-justify-content-between">
                    <svg xmlns="http://www.w3.org/2000/svg" style="height:14px;width:14px;" viewBox="0 0 20 20"
                        fill="#000">
                        <path fill-rule="evenodd"
                            d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                            clip-rule="evenodd" />
                    </svg>
                    <p class="article-meta__published-date">Tuesday, April 12, 2022</p>
                </div>
                <div class="article-meta__author__div is-flex is-flex-direction-row is-justify-content-between">
                    <svg xmlns="http://www.w3.org/2000/svg" style="height:14px;width:14px;" viewBox="0 0 20 20"
                        fill="#000">
                        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                            clip-rule="evenodd" />
                    </svg>
                        <p class="article-meta__author">Alexis C. GRIDEL</p>
                </div>
            </div>
        </div>
        <p>Have you noticed an error in this article? Do not hesitate to correct it, the site is open-source! <a href="https://github.com/Inerska/inerska.github.io" target="_blank">https://github.com/Inerska/inerska.github.io</a></p>
    </div>
</section>
        <main class="container is-max-desktop content__spacing body__fullheight section">
            <p>Regarding the MSDN docs about the String class, it's an immutable array of characters. Even if you try to change it, like using the ToUpper() method or ToLower(), it will give you a copy of your string.</p>
<blockquote>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.string?view=net-6.0">String Class (System) | Microsoft Docs</a></p>
</blockquote>
<pre><code class="language-csharp">/// &lt;summary&gt;

/// The goal of this function is to lower a string.

/// In the game, it will appear as a whisper.

/// &lt;/summary&gt;

public static void Whishiper(this String source)

{

    source = source.ToLower();

    Console.WriteLine(&quot;It looks like someone's seems saying something.&quot;);

}

public static void Main()

{

    User bob = new User(&quot;Bob&quot;, UserType.Gangster);

    User remy = new User(&quot;Rémy&quot;, UserType.Victim);

    var warningMessage = &quot;Be careful, I won't kill you !&quot;;

    bob.TalksWith(remy, warningMessage.Whishiper());

}
</code></pre>
<p>This snippet, will create two users, Bob and Rémy, Bob's talking with Rémy the warning message, &quot;Be careful, I won't kill you !&quot;. Obviously if you have some experiences in programming, thanks to the method extension on String, which is a bad idea by the way, will lower the message to &quot;be careful, i won't kill you !&quot;. However, the ToLower() method will be returned by copy.</p>
<blockquote>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.string.toupper?view=net-6.0">String.ToUpper Method (System) | Microsoft Docs</a></p>
</blockquote>
<p>Every String methods return a copy of the string, because String is immutable by default in C# and a lot of other languages.</p>
<p>Notwithstanding something exists to overcome this issue even if it's not an actual one, in a rare situation when you will need to edit a String and you don't want a copy but a reference, for optimization purposes for example, you can use fixed in an unsafe block.</p>
<p>In brief, the fixed keyword is rarely used when you want to fix the variable in memory, I will talk more about it in a next article.</p>
<p>If you want to use unsafe keywords inside your code you have to enable it in your .csproj file.</p>
<p><code>&lt;AllowUnsafeBlocks&gt;true&lt;/AllowUnsafeBlocks&gt;</code></p>
<pre><code class="language-csharp">string ReplaceFirstLetterWith(string source, char replacedCharacter)

{

        return source.Replace(source.ElementAt(0), replacedCharacter);

}   

Console.WriteLine(ReplaceFirstLetterWith(&quot;Bello World!&quot;, 'h'));
</code></pre>
<p><em>FYI: this code is pretty bad because we are not checking if the string is null/empty</em></p>
<p>This snippet will replace the first letter with another character and results in &quot;hello World!&quot;, pretty good right ? But the .Replace() method will return a copy, and that may be something we don't want.</p>
<pre><code class="language-csharp">unsafe void ReplaceFirstLetterWith(string source, char replacedCharacter)

{

        fixed(char* ptr = source)

        {

                ptr[0] = replacedCharacter;

        }

}

const string sourceExample = &quot;Hello World&quot;;

ReplaceFirstLetterWith(sourceExample, 'h');

Console.WriteLine(sourceExample);
</code></pre>
<p>This snippet will result the same, except that we are modifying the source value and not making a copy anymore. A lot of times, you don't want to do it that way. But it's a good thing to know in my opinion.</p>
<p>We are making a pointer in source and editing the unreferenced pointered first character of the string, easy right ?</p>

        </main>
        
        <footer class="footer has-bg-dark">
    <div class="container">
        <div class="content has-text-centered">
            <p class="text-align-center">
                <svg class="is-small__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                     fill="currentColor">
                    <path fill-rule="evenodd"
                          d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z"
                          clip-rule="evenodd" />
                </svg>
                with
                <svg class="is-small__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                     fill="red">
                    <path fill-rule="evenodd"
                          d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"
                          clip-rule="evenodd" />
                </svg>
                by
                <span class="has-text-weight-bold">Alexis C. GRIDEL</span>
            </p>
        </div>
        <!--<div class="underneath">
            <div class="columns has-text-centered">
                <div class="column">
                    First column
                </div>
                <div class="column">
                    <span class="has-text-semibold">Social</span>

                </div>
            </div>
        </div>-->
    </div>
</footer>

        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/components/prism-core.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/plugins/autoloader/prism-autoloader.min.js"
            data-no-mirror></script>
        <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {

                const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);

                if ($navbarBurgers.length > 0) {

                    $navbarBurgers.forEach(el => {
                        el.addEventListener('click', () => {

                            const target = el.dataset.target;
                            const $target = document.getElementById(target);

                            el.classList.toggle('is-active');
                            $target.classList.toggle('is-active');
                        });
                    });
                }

            });
        </script>
        <script src='https://storage.ko-fi.com/cdn/scripts/overlay-widget.js'></script>
        <script>
            kofiWidgetOverlay.draw('alexisgridel', {
                'type': 'floating-chat',
                'floating-chat.donateButton.text': 'Support me',
                'floating-chat.donateButton.background-color': '#00b9fe',
                'floating-chat.donateButton.text-color': '#fff'
            });
        </script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-F82ML3P5DK"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());

            gtag('config', 'G-F82ML3P5DK');
        </script>
    </body>

</html>